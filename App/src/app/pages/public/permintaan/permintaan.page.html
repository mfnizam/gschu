<ion-header class="ion-no-border drop-shadow-md">
  <ion-toolbar>
    <ion-buttons slot="start" class="-mr-4">
      <ion-back-button></ion-back-button>
    </ion-buttons>
    <ion-title class="text-bold">
      Daftar Permintaan
    </ion-title>
  </ion-toolbar>
  <ion-toolbar *ngIf="user?.atasan || user.gs">
    <ion-segment scrollable [(ngModel)]="segment">
      <ion-segment-button value="menunggu">
        <ion-label><b>Menunggu Persetujuan Anda</b></ion-label>
      </ion-segment-button>
      <ion-segment-button value="disetujui">
        <ion-label><b>Telah Anda Setujui</b></ion-label>
      </ion-segment-button>
      <ion-segment-button value="ditolah">
        <ion-label><b>Telah Anda Tolak</b></ion-label>
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-refresher slot="fixed" (ionRefresh)="ambilPermintaan($event, false)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>
  <div class="flex items-center ion-padding-top ion-padding-end" style="overflow-x: auto;">
    <div
      class="flex-shrink-0 ion-margin-start text-primary pl-4 pr-4 pt-2 pb-2 border rounded-full border border-primary flex items-center gap-2">
      <b>Semua Status</b>
      <ion-icon name="chevron-down"></ion-icon>
    </div>
    <div
      class="flex-shrink-0 ion-margin-start text-primary pl-4 pr-4 pt-2 pb-2 border rounded-full border border-primary flex items-center gap-2">
      <b>Semua Tanggal</b>
      <ion-icon name="chevron-down"></ion-icon>
      <!-- <ion-icon name="calendar-clear-outline"></ion-icon> -->
    </div>
  </div>
  <div class="ion-padding">
    <div *ngIf="!isLoading; else permintaanLoading">
      <div *ngIf="permintaan && permintaan.length > 0; else noPermintaan">
        <div *ngFor="let p of permintaan" class="rounded-lg ion-padding ion-margin-bottom bg-background drop-shadow-md"
          [routerLink]="'/detail/' + p._id">
          <div class="flex items-center ion-margin-bottom">
            <div class="flex-1">
              <small class="text-medium">Jenis Permintaan</small>
              <div class=" text-bold">{{p.jenis}}</div>
            </div>
            <div [ngClass]="'bg-' + p.kategori + ' text-on-' + p.kategori" class="flex p-2 rounded-lg rounded-lg">
              <img [src]="'assets/icon/' + p.kategori + '.png'" class="mb-px" style="width: 20px; height: 20px;">
            </div>
          </div>
          <div class="flex items-center">
            <div class="flex-1">
              <small class="text-medium">Status</small>
              <div class="ion-no-margin text-bold">Menunggu Persetujuan</div>
            </div>
            <div class="text-right">
              <small class="text-medium">Tgl Permintaan</small>
              <div class="ion-no-margin text-bold">{{p.createAt | date:'dd MMMM YYYY'}}</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <ng-template #noPermintaan>
      <div class="ion-padding border rounded-xl text-center text-medium">Tidak Ada Data Permintaan <br> Silahkan buat permintaan.</div>
    </ng-template>
  </div>
  <ng-template #permintaanLoading>
    <div class="skeleton">
      <div class="bg-background ion-margin-bottom ion-padding rounded-xl drop-shadow-md" style="height: 136px;">
        <div class="bg-light rounded-md" style="width: 30%; height: 12px; margin-top: 7px;"></div>
        <div class="bg-light rounded-md animate" style="width: 80%; height: 14px; margin-top: 6px;"></div>
        <div class="grid grid-cols-2 gap-3" style="margin-top: 28px;">
          <div>
            <div class="bg-light rounded-md" style="width: 20%; height: 12px;"></div>
            <div class="bg-light rounded-md animate" style="width: 100%; height: 14px; margin-top: 6px;"></div>
          </div>
          <div class="flex flex-col items-end">
            <div class="bg-light rounded-md" style="width: 50%; height: 12px; float: right;"></div>
            <div class="bg-light rounded-md animate" style="width: 80%; height: 14px; margin-top: 6px; float: right;"></div>
          </div>
        </div>
      </div>
      <div class="bg-background ion-margin-bottom ion-padding rounded-xl drop-shadow-md" style="height: 136px;">
        <div class="bg-light rounded-md" style="width: 30%; height: 12px; margin-top: 7px;"></div>
        <div class="bg-light rounded-md animate" style="width: 80%; height: 14px; margin-top: 6px;"></div>
        <div class="grid grid-cols-2 gap-3" style="margin-top: 28px;">
          <div>
            <div class="bg-light rounded-md" style="width: 20%; height: 12px;"></div>
            <div class="bg-light rounded-md animate" style="width: 100%; height: 14px; margin-top: 6px;"></div>
          </div>
          <div class="flex flex-col items-end">
            <div class="bg-light rounded-md" style="width: 50%; height: 12px; float: right;"></div>
            <div class="bg-light rounded-md animate" style="width: 80%; height: 14px; margin-top: 6px; float: right;"></div>
          </div>
        </div>
      </div>
      <div class="bg-background ion-margin-bottom ion-padding rounded-xl drop-shadow-md" style="height: 136px;">
        <div class="bg-light rounded-md" style="width: 30%; height: 12px; margin-top: 7px;"></div>
        <div class="bg-light rounded-md animate" style="width: 80%; height: 14px; margin-top: 6px;"></div>
        <div class="grid grid-cols-2 gap-3" style="margin-top: 28px;">
          <div>
            <div class="bg-light rounded-md" style="width: 20%; height: 12px;"></div>
            <div class="bg-light rounded-md animate" style="width: 100%; height: 14px; margin-top: 6px;"></div>
          </div>
          <div class="flex flex-col items-end">
            <div class="bg-light rounded-md" style="width: 50%; height: 12px; float: right;"></div>
            <div class="bg-light rounded-md animate" style="width: 80%; height: 14px; margin-top: 6px; float: right;"></div>
          </div>
        </div>
      </div>
    </div>
  </ng-template>
</ion-content>

